var fs      = require('fs');
var Twitter = require('twitter');
 
var client  = new Twitter({
  consumer_key        : process.env.TWITTER_CK  ,
  consumer_secret     : process.env.TWITTER_CS  ,
  access_token_key    : process.env.TWITTER_ATK ,
  access_token_secret : process.env.TWITTER_ATS
});

console.log( process.env.TWITTER_CK ) ;

var WebSocketServer = require('websocket').server ;
var http            = require('https') ;

var processRequest = function( req , res ) {
        res.writeHead(200) ;
        res.end("O_o?!");
};

var server = http.createServer({
            key  : fs.readFileSync( process.env.PRPR_KEY ) ,
            cert : fs.readFileSync( process.env.PRPR_CER )

} , processRequest ).listen( 8443 ) ;

wsServer = new WebSocketServer({
    httpServer            : server ,
    autoAcceptConnections : false
});

wsServer.getDate = function() {
    var mm = new Date().getMonth() + 1 ;
    var dd = new Date().getDate() ;

    mm = mm < 10 ? "0" + mm : mm.toString() ;
    dd = dd < 10 ? "0" + dd : dd.toString() ;

    return mm + dd ;
}

wsServer.start_date = wsServer.getDate() ;

console.log("start_date: " + wsServer.start_date) ;

wsServer.twi     = client ;

wsServer.getType =  function getType(ll , na) {
    var result = 10000 ;

    if ( ll == "Lv100") {

        result = 10000 ;

        if ( na == "ティアマト・マグナ" )       { result = 10001 ; }
        if ( na == "ティアマト・マグナ＝エア")  { result = 10001 ; }
        if ( na == "コロッサス・マグナ" )       { result = 10002 ; }
        if ( na == "リヴァイアサン・マグナ" )   { result = 10003 ; }
        if ( na == "ユグドラシル・マグナ" )     { result = 10004 ; }
        if ( na == "シュヴァリエ・マグナ" )     { result = 10005 ; }
        if ( na == "セレスト・マグナ" )         { result = 10006 ; }
        
        if ( na == "フラム＝グラス" )          { result = 10010 ; } // 10007
        if ( na == "マキュラ・マリウス" )      { result = 10010 ; } // 10008
        if ( na == "メドゥーサ" )              { result = 10010 ; } // 10009
        if ( na == "ナタク" )                  { result = 10010 ; } // 10010
        if ( na == "アポロン" )                { result = 10010 ; } // 10011
        if ( na == "Dエンジェル・オリヴィエ" ) { result = 10010 ; } // 10012

        if ( na == "グラニ" )                  { result = 10020 ; }
        if ( na == "オーディン" )              { result = 10020 ; }
        if ( na == "リッチ" )                  { result = 10020 ; }
        if ( na == "アテナ" )                  { result = 10020 ; }
        if ( na == "バアル" )                  { result = 10020 ; }
        if ( na == "ガルーダ" )                { result = 10020 ; }
    }
 
    if ( ll == "Lv120") {

        result = 10000 ;

        if ( na == "フラム＝グラス" )          { result = 12020 ; }
        if ( na == "マキュラ・マリウス" )      { result = 12020 ; }
        if ( na == "メドゥーサ" )              { result = 12020 ; }
        if ( na == "ナタク" )                  { result = 12020 ; }
        if ( na == "アポロン" )                { result = 12020 ; }
        if ( na == "Dエンジェル・オリヴィエ" ) { result = 12020 ; }
    }

    if ( ll == "Lv20" || ll == "Lv30" || ll == "Lv50" || ll == "Lv60" || ll == "Lv70" || ll == "Lv75" ) { // != 100 && != 120 ?

        result = 999 ;

        if ( na == "ティアマト・マグナ" )      { result = 1 ; }
        if ( na == "コロッサス・マグナ" )      { result = 2 ; }
        if ( na == "リヴァイアサン・マグナ" )  { result = 3 ; }
        if ( na == "ユグドラシル・マグナ" )    { result = 4 ; }
        if ( na == "シュヴァリエ・マグナ" )    { result = 5 ; }
        if ( na == "セレスト・マグナ" )        { result = 6 ; }
    }

    if ( ll == "Lv150" ) { result = 10000 ; }
    
    return result ;
}

wsServer.connList       = [] ;
wsServer.codeList       = [] ;
wsServer.userList       = {} ;
wsServer.tcList         = [] ;

wsServer.dcodeList      = [] ;

wsServer.typecounts     = {} ;

wsServer.byRequestCount = 0 ;
wsServer.byStreamCount  = 0 ;

wsServer.getOutput = function () {
	var output    = {} ;
	var outputStr = "" ;
	
	output.prpr = this.codeList ;
	output.info = { "connections" : this.connList.length  ,
                    "lut"         : new Date().toString() , 
                    "rc"          : this.byRequestCount   ,
                    "sc"          : this.byStreamCount    ,
                    "typecounts"  : this.typecounts
                  } ;
	
	outputStr = JSON.stringify(output) ;
	
	return outputStr ;
}

wsServer.doWall = function () {
	var output = this.getOutput() ;
	
	this.connList.forEach(function(element , index , list) {
		if( element.connected ) { element.sendUTF(output) ; } 
	})
	
	this.doClearCodeList() ;

    var ustr = JSON.stringify(this.userList) ;

    fs.writeFile("/usr/share/nginx/html/ws/userlist-" + wsServer.start_date + ".json" , ustr , function(err) {
            if(err) {
                return console.log(err);
            }
    }) ;
}

wsServer.doClearCodeList = function () {
	this.codeList   = [] ;
    this.typecounts = {} ;
}

wsServer.doAddCodeList = function ( val ) {
	this.codeList.push ( val ) ;
}

wsServer.isInCodeList = function ( code ) {
    this.codeList.forEach( function(element) {
        if( element.code == code ) {
            return true ;
        }
    }) ;
    return false ;
}

wsServer.doParseTime = function ( val ) {
    return (val.getHours()   < 10 ? "0" + val.getHours()   : val.getHours()   ) + ":" +
           (val.getMinutes() < 10 ? "0" + val.getMinutes() : val.getMinutes() ) + ":" +
           (val.getSeconds() < 10 ? "0" + val.getSeconds() : val.getSeconds() ) ;
}

wsServer.doParseTweet = function ( tweet , typeby ) {
    try {
        var content = tweet.text ; 
        var c1      = content.split("参戦ID：")[1] ; 

        if ( c1 == null || c1.length <= 0 ) { return } ;

        var c2      = c1.split("\n")[1] ; 
        var code    = c1.split("\n")[0] ; 
        var info    = c2.split(" ") ;
        var level   = info[0] ; 
        var name    = info[1] ; 
        var time    = new Date(tweet.created_at) ;
        var ftime   = this.doParseTime(time) ; 
        var sname   = tweet.user.screen_name ;
        var sid     = tweet.user.id_str ;
        var type    = this.getType(level , name) ;
                    
        var obj     = { "kind"  : type  , 
                        "lv"    : level , 
                        "code"  : code  , 
                        "name"  : name  , 
                        "sname" : sname ,
                        "ftime" : ftime , 
                        "by"    : typeby 
                       } ;

        if ( code == null || code == "" ) { return ; }
        if ( name == null || name == "" ) { return ; }
        
        var isAdd   = this.tcList.indexOf( code ) ;

        if ( this.userList[sid] == null ) {
             this.userList[sid] = 1 ;
        } else {
            if ( isAdd == -1) {
                this.userList[sid] = this.userList[sid] + 1 ;
            }
        }

        if ( this.tcList.length >= 1000 ) { this.tcList = [] ; }
        this.tcList.push( code ) ;
    
        if ( !this.isInCodeList() ) { this.doAddCodeList(obj) ; }

        if ( isAdd == -1 ) {  
            this.dcodeList.push ( obj ) ;

            if ( this.typecounts[type] == null ) {
                this.typecounts[type] = 1 ;
            } else {
                this.typecounts[type] ++ ;
            }

            if ( typeby == "request" ) {
                wsServer.byRequestCount ++ ;
            } else {
                wsServer.byStreamCount ++ ;
            }
        }
    }
    catch(e) {
        console.log("===========") ;
        console.log(tweet.text) ;
        console.log("c1=" + c1) ;
        console.log("c2=" + c2) ;
        console.log(e) ;
        console.log("===========") ;
    }
}

function originIsAllowed( origin ) {
  return true ;
}

wsServer.on('request' , function( request ) {
    if ( !originIsAllowed( request.origin ) ) {
      request.reject() ;
      console.log( (new Date() ) + ' Connection from origin ' + request.origin + ' rejected.' ) ;
      return ;
    }

    var connection = request.accept( 'echo-protocol' , request.origin ) ;
    
    connection.cKey = request.key ;   
    this.connList.push( connection ) ;
    
    console.log( (new Date() ) + ' Connection accepted. key: ' + request.key ) ;
    console.log( (new Date() ) + ' online-count: '             + this.connList.length ) ;
    
    var outputStr = this.getOutput() ;
	
    connection.sendUTF( outputStr ) ;
    
    connection.on('message' , function( message ) {
        if ( message.type === 'utf8' ) {
        }
    });
    
    connection.on('close', function(reasonCode, description) {
        console.log((new Date()) + ' Peer ' + connection.remoteAddress + ' disconnected.') ;
        console.log((new Date()) + ' online-count: '                   + wsServer.connList.length) ;
    });
});

setInterval(function(target) { 
	var outputStr = target.getOutput() ;
	
	target.connList.forEach(function(element , index , list) {
		if( !element.connected ) { console.log("clear connection: " + element.remoteAddress) ; list.splice(index , 1) ; }
		if( element.connected ) { element.sendUTF(outputStr) ; } 
	})

    target.twi.get("search/tweets" , {"q" : "参戦ID" , "count" : 80} , function(error, tweets, response){

        var counter = [] ;

        if ( tweets != null && tweets.statuses != null ) {
            tweets.statuses.forEach(function(item){
                target.doParseTweet(item , "request") ;
            })
        }
    })

    target.doWall() ;

    var now_date = target.getDate() ;

    if( target.start_date != now_date) {
        console.log( "[INFO] date-change! reset and update start_date! :: " +  target.start_date + " vs " + now_date) ;
        target.userList   = {} ;

        target.byRequestCount = 0 ;
        target.byStreamCount  = 0 ;

        var dcodestr = JSON.stringify(target.dcodeList) ;

        fs.writeFile("/usr/share/nginx/html/ws/codelist-" + wsServer.start_date + ".json" , dcodestr , function(err) {
            if(err) {
                return console.log(err);
            }
        }) ;

        target.start_date = now_date ;
    } 


} , 5000 , wsServer) ;


//var userids = "711133585214812200,2656043682,160445031,1675964808,2880669368,700697118411915300,770710022753964000,2413620884,2433716941,3242021510,3026432563,3515660842,134056781,715397312982294500,124758250,510361337,129452576,409774384,4513270693,4753357937,736700707777089500,721815471377350700,720834216737398800,716089040378814500,2262333330,718597567269843000,1854680240,596550735,708271021158105100,727438077350703100,2881625677,2430318553,4805100944,3228159758,116644889,19539564,624343345,2614668972,2182517773,2257670005,1620835362,555651344,709762180921425900,715455095068954600,4359761654,2908908318,1170403310,3152825507,2418122046,3283128678,585241339,4889285339,378423277,345322552,4306059314,4849092520,2988890496,4576811294,169865027,740726184179163100,3194811973,735660427254714400,635484875,3232931377,3038367708,4833453260,737257274582827000,831297361,697814574355976200,2912412054,3158516958,736055992568270800,1432861058,3987275899,2232699450,793095258,2283275016,3171141540,704256984028024800,762993470118072300,4841211674,564932345,2172545768,2451333584,89951980,4849678346,1596902252,766565768280412200,2898780144,2785454742,747877981301837800,757276379700351000,732888126847230000,3966332665,3925994713,4173669194,3912559873,1942865192,3314107411,2357951221,748355547116671000,3191521421,718183643395457000,1615797888,144572414,1454525574,3137173508,753421158062579700,2800294297,2876582335,740602621816234000,151134773,4893895939,756085219677970400,719899035633590300,3245910828,747078602110296000,4303190903,3820727234,2893748172,3739021398,763983736429871100,3328197224,718401416310743000,746284613060821000,3788860212,906498992,3304180152,820788486,718004979038990300,2772748656,4654189940,1122293372,3053104471,3312329354,701735313446600700,769763614714503200,3038912822,2168472703,725718595242618900,730656882071736300,2808905737,1474624110,2655072104,544168347,3733293434,581731614,726413451229175800,3049850401,584897809,711417388353257500,4886948038,192898265,2469254562,3344400734,710504574566543400,1114090003,1134684438,713791638330429400,762687216095113200,2496689359,1657861904,340017287,3261939547,1676865248,2842766724,2743784112,719505042642903000,2873538504,711205392970227700,2181760152,4833347197,722099085130338300,1329552488,4888973021,4430040980,4805779255,1461554468,4642730779,246128237,1414692115,767269781858684900,720169339781972000,757617759719088100,752749802,769561213856456700,14712244,1568712188,4655837240,4737435253,2281628262,754541410146132000,2880408151,3960072192,2441618562,2652948962,3009604310,958772389,1026531427,768838302866690000,864288811,723303699305504800,3184143200,711151800800272400,746857097732591600,4051986854,770897413078777900,726699279092305900,715253821132267500,2425084230,357263379,2451333878,1353190604,769605056144379900,718838194632921100,2248521517,727507031490367500,755061395473915900,2841044894,3335843720,1487723179,172676955,2158778210,744062463906316300,727632310154076200,4593876805,177970610,250591263,439036497,260973455,3012643796,100936560,2441186438,724956708246839300,2920645350,766331015866490900,3149321378,1954869187,1673613907,2711511494,726796808412758000,3186991411,1682105755,606259885,2886830724,732178648833261600,2420283282,770135648653209600,4165511713,2352128916,2354346674,762697420480274400,2803268300,506057650,2978880930,2958545754,3014302946,3118545099,4903760839,1727853398,763051160500473900,4773792614,242703309,748307944958136300,756511333294669800,2805658088,873886423,914578344,743783702283460600,719500684295417900,2291873984,2850540136,2898615277,206940515,437408822,766270974014722000,758045697555828700,178280793,1698986706,171760107,344072247,162919069,709543702075560000,708856455273689100,4731931164,1539740426,827022206,3668116093,2468252485,2939772974,3223466730,767739822542688300,4853211895,735143318300950500,746953219700490200,34613030" ;
var userids = "100164720,1004149160,1005514777,1006559454,1008707444,1012600554,1017542779,101940480,1024125332,1024478719,1024479194,102566854,1026531427,1026907784,102818012,102897833,1030060046,1033948716,1035010772,1040705905,1043403506,104413753,1045381453,1046752656,104870217,1050243229,1050819228,105089375,1053081596,1057313862,1062151076,1066198154,1066437732,107055615,1071196586,107329844,107340450,107421686,1076651090,1077168368,107744918,1078259036,1079217283,108032600,108552253,1086160220,109265121,109285918,109300352,1096909784,1097141300,1105309416,110531515,1106271408,110731522,1108621542,1108739828,1110482312,1113565309,1114090003,1127460181,113021013,113385649,1134684438,1135544952,114147744,1141879141,1144680806,1145259644,114768068,1153806750,115608777,1157372929,1157502890,115930902,1159897783,116352148,116644889,116723120,116761671,1167795096,116952397,1170403310,1171565918,117414915,118088959,118140874,118589378,1191845089,119369852,119396918,1195579628,119591633,119695603,120341366,120396083,121367502,1214075467,1214328342,1217122279,121980397,1220474179,1221675438,1223375130,1224056504,122413240,122768270,122901497,1229216070,1234126866,123537387,123543619,123545178,123567629,1238865823,1241426798,1242391795,1243357465,124716767,124800505,1253156593,1253373926,1257422413,126531628,1272331188,127540553,127904619,128247956,1282707278,1282855238,128479196,128706217,1288061203,128900440,1290029562,129209401,129211678,1292305207,1293989388,129452576,1294682204,1306671012,1308980665,131393419,1317765223,132019133,132119348,1322769168,1323926276,1326600048,1326617701,132913360,132936057,1329552488,1330980168,1336895821,1338331706,1338743383,1339342620,133953621,134056781,1343895301,1351045062,1351995966,1353190604,135429499,135873074,136271876,1364994577,1366348213,1369675350,1369903489,137356895,137669901,137728371,137953758,1382849640,138375988,1384448342,138738729,138783496,1392381349,139264284,140220751,1402597795,1404961513,1405144980,1407092557,1409967421,1411072232,141309096,1413519361,1414692115,141552698,1417047577,1418360047,1421244445,1423528842,142438810,1425125840,1426203205,1428039145,1428046284,1429114356,142927814,1432861058,1433650267,1433873125,1434725365,1436200213,1437606884,1437683281,143819781,1438569985,144440488,1445569357,144572414,1445834623,1446759972,1448950364,1454525574,1455040621,1460098459,146123875,1461928692,146370851,146431983,146518953,1467415832,146845431,1469404813,1469538613,14712244,1471569170,1473359612,1473651086,1473733574,1473930630,1474237272,1474257332,1476917252,1479661927,1481040390,148343194,1484417774,1487723179,1488464190,1492053127,14954810,149786019,149927548,1503758557,1510263330,1510301634,151088651,1511345514,151134773,151380960,1519524414,1522160509,152348248,1524884310,1527547789,153051867,153322422,153898947,1539740426,1540566042,1540790276,1542344810,154338459,154365730,154467389,1546014338,154657678,1546692248,154674708,1547626717,154875734,1549334202,154998126,155152551,155520753,1556208824,1556856366,1557889861,155952001,1559727506,1563085381,1565426395,1565934277,156646769,1567559826,1568389212,1568445493,1568712188,156924698,1571883138,1582674506,1582912616,1583370169,158635309,1586460824,158774595,1588721318,159007016,159541843,1596902252,1601311183,160162457,160607348,16065875,1608146706,1608547184,1615167398,1615797888,1617100314,1617717847,1617983473,1620835362,1622065046,1622571385,162588053,162771612,162919069,163029953,1633607623,1634674260,1635650760,163607290,163723737,1640851440,1642945632,1644975608,1645140978,1647814352,164969056,16555492,165994413,1660765057,1661918971,1664363900,1664420462,166629799,166821874,167306297,1675964808,1676480916,1676865248,168456874,168520588,168536968,1685453682,1691982678,1694484188,1696298186,1698110156,1698214400,1698986706,1699867866,1701526908,170268033,17074844,1713403711,1714526940,1714595822,1715113675,1715416868,1716152131,1716347934,1717349336,171760107,171762073,1718992142,1724894018,172676955,1727853398,173010765,1731400848,1735158986,1739019234,175590732,175748128,177445609,177458882,177509416,177510504,177970610,178139818,178280793,178783372,178946313,179109280,179878353,1804945626,180697899,180741993,1827657938,1828886503,184077374,1841144924,1847475619,1850186298,1854680240,185585796,1856592594,1856678102,186292378,1863295088,186420291,186736452,186835002,1870645626,1870945472,1871014687,187258389,1872598410,1873310215,187801105,188146445,188363029,188651847,1889183989,189033556,189091527,189199675,1896294889,190619776,190976514,1914243020,1914888470,191741082,191778450,1922743910,192625974,192671006,192898265,1931263705,1934775764,194218324,1942865192,1943305010,1943470382,1946369616,1946556288,1953302185,1953398240,19539564,1954869187,195624519,195697625,1956994212,1962073735,1962679074,1963685407,1967079108,1968420572,1969083656,1971965670,1973128741,1973675136,1975510237,197643238,1977975330,1978060267,199212627,200664571,200711298,201857950,203716785,205750119,206940515,206958467,207100440,210806955,210832543,211446255,212272075,212296863,213266448,213282537,213617253,213942078,214948021,2149742558,2150823656,2152435910,215266043,2153047404,2153193968,215427756,2154576530,215666491,215857215,2158778210,2159014040,2160211902,2160228504,2160461545,2163127908,2164183530,2165930784,2167655970,2168472703,2170728560,2172545768,2173841594,2177624834,2181425630,2181760152,2181809756,2182517773,218397937,2183980424,218552551,2185825758,2186446434,2187314179,218779751,218812661,2193565226,2193583842,2195229428,2197186938,2200425492,2202956563,2204592097,2206116121,2207263418,2207916548,2210450826,221058959,2212189968,2215303454,2217582145,2217968107,2223011010,2225737352,2226624614,2230968434,2231397632,223150603,2232699450,2233778971,223380818,2236158540,2236423682,2239027166,2239432320,2239866542,2240196535,2240501204,2242724761,2243219496,2247168782,2247240924,2247986353,2248521517,2249104273,224991814,225031079,2250328202,2250380168,22507541,2252241667,2252882580,2252949060,2253818438,2254785704,2255400408,2256570908,2256765631,2257619846,2257670005,2259161077,2260062380,226065426,2262333330,22632506,2264557880,226508361,2266086230,2268324104,2268695172,226873708,2269718660,2270330684,2270901360,2272701128,2272959810,2273860093,2276131488,2276221346,227819568,227953011,2279847834,228023996,228028886,228034573,2281547642,2281628262,2282233710,2282469422,2282509056,228288887,2283275016,2283553838,2283577585,2285280768,2287329211,2288049282,2290477291,2290865718,2290888412,2291873984,2292652243,2294462503,2294601636,2297714144,2299235466,2299555057,2301059576,2301090163,2304619933,230765745,2308212620,2310472027,2311569512,2313711798,2314725547,2314778550,2315051521,2315158053,2315162990,2315409349,2315603924,2316569778,2317915148,2318909306,2318945108,2321917662,2322251982,2323883035,2323930975,232555596,2327312509,2329888302,2331111355,2331462271,233500653,2335039350,2337742740,2339750994,2342228107,2343439244,2343591770,234373498,2348054197,2349374078,2350369459,2350821955,2351524862,2352128916,2354346674,2355813174,2356355347,2356769954,2357341279,2357951221,236024167,2362299883,236250275,2363385218,236459285,2368783987,2370219570,237190172,2373919694,2374642968,2378429198,2379935478,2380813308,2382284215,2383513058,2384150358,2388781538,2388976495,2390426358,2390430452,2392218560,2393342598,2393828672,2394054271,2394418142,2394760866,2397345841,2399941830,2401776163,2404956288,2406507146,240737257,2408228570,2410858268,2412424345,2413620884,2414192701,2417415409,2418122046,2418630985,241961481,2420283282,2421473227,2421509497,2422079468,2422799755,2423348168,2424668203,2425084230,2426627616,242703309,2427809762,242869428,2428978110,2429092956,2430797546,2433716941,2434660783,2435958404,2438327466,243991518,2440575697,2441186438,2441618562,2441801288,244516263,244545667,2446618430,2451333584,2451333878,2454091626,2455955473,2456683550,2461060574,246128237,2465428856,2465474029,2468252485,2469254562,2470871030,2472010850,2473542204,2473815181,2474234641,2479245960,248016815,2481234102,2483285870,2484815449,2486725707,2487749862,2494140090,2496689359,2498337674,2499032887,2499459157,249950622,250591263,250695500,2507110141,2507579640,251025812,251030783,2511770732,2515349426,2515705009,2516915208,2517840589,2520508962,2520748680,2523649754,2524055810,2524659169,2527310076,2528028674,2537509368,2538172789,2539180723,2544947858,2546237211,2546293710,254732313,254862580,2549756994,254998058,2550467629,2550787080,255096791,2553800706,2555964739,2560671529,2562002370,2568269304,2568937076,2570206158,2570306087,2571289460,2571933156,2572411490,2575099412,2575677145,2576761087,2577936062,2580235148,2582166175,2583731384,2586133788,2587143349,2587223144,2587565466,2590939554,2591897052,2592073015,2593944805,259641713,2597562055,2598282974,2601405636,2603484498,2605458722,260551284,2605523588,2605617008,2607048530,2608845013,260916958,260973455,2614668972,2617071985,2617151772,262556826,263126782,2631304064,263933734,264122806,2644522608,2646946938,2647024392,264723677,264785148,2649803761,2652916296,2652948962,2656043682,2657375636,265765342,266030637,2662051908,266628643,2669086477,2669535432,2670069140,267014993,2670858019,2673145778,2673414085,2673675260,2676116580,2676128323,268100472,2688950162,2692057231,2692961672,2693122850,2693408408,2693759582,269454522,269611930,2696402630,26973029,269747996,2697815449,2698170222,2698253688,2703740430,2703780950,270393921,2704328826,270479554,2707988900,2708893964,2710117346,2711146393,2711511494,2711549112,2711941777,2713071282,2713191193,2713918670,271473712,2715735997,27163673,2716579872,2717017447,2717541930,2718905083,2719692282,2721326731,2721908870,2723658060,2725838383,2726231198,2727913230,2728568918,272884353,2729064607,272996072,2730580900,2731104582,2731198154,2731489999,2731726891,2737200273,2737339261,273822255,2740050846,2746177656,2748098121,2752238347,2752357945,275994398,276015051,2760689304,2760940836,2763119784,2765314098,2770090868,2770138083,2770552994,2772210816,2772463387,2772748656,2772802812,277322186,277482059,2777809165,2778619284,277881838,2780410363,2780484752,2780566447,2780765940,2781692124,2783662801,2785454742,2785697144,2785796346,2788682714,2789101399,2789635560,2790935426,279098916,2791843908,2791858116,2793580250,2794386698,2795271662,2795465309,2795861940,2796043729,2797585243,2797754222,2798152650,2798887412,2799248491,2800294297,2801031145,2801144088,2802219931,2805155306,2805334916,2805493123,2805603702,2805658088,2806874868,2808020647,2808752216,280936831,2811154344,2811717864,2812711680,2813848993,2813859547,2814025285,2814771852,2816679806,2816950772,2819242164,2820198620,2821253414,2825591438,2828366621,2831066418,2831131874,2831288708,2833541576,2833614644,2834998974,2836516981,2836619666,2837788746,2838857034,2839136383,2839481281,2839914602,2841011706,2841044894,2841114716,2841656918,2842766724,2843536056,2843948642,2848051339,2848190510,2849631271,2849939364,2850540136,2851623036,2854045902,2854336710,285547855,2855556523,2859316758,2859527358,2859712550,2861922199,2861949511,2862768234,2865311312,2867866506,2868486781,2868662718,2868833478,2874978409,2875954651,2876582335,2876790278,2878419475,2878850078,2880408151,2880669368,2881601718,2881625677,2881661797,2882105772,2883017940,2883074228,2883205266,2884478750,2885061583,2885276862,2886830724,2887617085,2888373072,2889675642,2889775554,2892507715,2892986438,2893748172,2893783968,2895567877,2895649904,2896318656,2897400660,2897499612,2897725237,2898055224,2898127483,2898615277,2898780144,2900870094,2901261518,2901675997,2903342198,2903478318,2903538276,2903643211,2903807672,2904228950,2904296317,2904811716,2904889770,2906170706,2907304406,2907481820,2907801067,2908250090,2908908318,2909694205,2910845534,2911512434,2911744896,2911939212,2911945879,2912275212,2912376518,2912412054,2912432617,2912665872,2912687119,2912884099,2912902621,2913003751,2913808159,2914396886,2914618470,2914631485,2914639927,2915497020,2915617700,2915628798,2915892488,2916049388,2916171600,2916819433,2917352112,2917512770,2918348874,2918741372,2918943398,2919347899,2920122900,2920259563,2921600917,2922081944,2923613317,2923976797,2924277216,2925567224,2926912160,2927609786,2928210422,2928845197,2929019636,2929554486,2930848939,2931310670,2933058740,293396661,293431215,2935380558,2935608301,2939156172,2939224513,2939476974,2939772974,2940466956,2941473864,2941824727,2942243389,2942512304,2942868858,2943185617,2944549855,2953013606,2953452378,2955538063,2955738739,2955977539,2958584047,2958694814,2958711960,2959317824,2962326936,2962904720,2963239425,296438122,2969177467,2969547439,2969625102,2975105078,2976302748,2976755802,2978678611,2978880930,2981911442,2982118572,2983079605,2984716117,2985610994,2986439755,2986722727,2988890496,2989658060,2990076824,2991647449,2992361751,2992378584,2994723487,2996017416,2996453978,2998835677,2999348162,2999597713,3003543607,3003624806,3006300050,3006338191,3007911745,3009329702,3009690385,3009757885,3009997870,3010315740,3010695235,3011262392,3011912438,301237592,3012643796,3013104541,3014302946,3014347208,3016115419,3017078644,3017683785,3018541194,3019047217,3020114395,3020372298,3021425816,3022807606,3024220254,3025605085,302777283,3032154409,3032272866,3032379835,3033786494,3035147958,3038367708,3038523180,3038534100,303861471,3038912822,3038933311,3039374161,3039506246,3039718764,3040033604,3040822770,3041301510,3041412763,3041524639,304309667,3044895738,3045392750,3047473885,3049415060,3049650511,3049692492,3049752966,3049850401,3050001420,3050026322,3050078407,3050079751,3050138516,3050156024,3050221400,3050294000,3050357598,3050405474,3050446086,3050514344,3050625138,3050655254,3050797987,3050843287,3050910193,3051733838,3052084033,3052197991,3052359566,3052569096,3052791596,3052849639,3053293946,3054183836,3054436128,3054519234,3054682471,305547033,3056311002,3056546390,3058789150,3059228034,3059652001,306210707,3062369814,3062642491,3062796306,3063232687,3063325157,3063748099,3065363246,3066236766,3066662899,3068945006,3069651026,3069690061,3069944586,3070546274,3071110267,3072926180,3073335355,3073388304,3075256699,3076866193,3077474172,3080815148,308797774,3088507364,3089442786,308966353,3089779352,3092708322,3095982740,3096122041,3098267220,3098442420,3099667490,310082528,310106195,3101657767,3101657785,310290817,3103347150,3104559806,3106685408,3106816896,3106833428,310794265,3108393738,310973719,3110838478,3112259376,3112460194,3112870159,311307267,3116031086,3116336208,3116789390,3117097082,3118412295,3118545099,3120906415,3120937188,3122621940,3122632274,3123434912,3128855466,3130197985,3131994008,3132579325,3137173508,3138285750,3138412014,3139517222,3143110386,3144570984,3144841193,3149321378,3149443412,3149548334,3151299198,3152660426,3153240374,3157309884,3158516958,3160634623,3161155058,3161437362,3161635273,3161751673,3161885370,3162032569,3164741952,3166115325,3167000938,3167393870,3167531125,3167572512,3167602494,3168386000,3171141540,3171501470,3177191971,3177626305,3178250574,3179402192,3179431442,3182700876,3184143200,3184314685,3184559017,3184654184,3184788727,3185443394,3185747534,3186214566,3186304921,3186991411,3187957711,3187959968,3188367031,3190287433,3191521421,3191985188,3193364896,3193680451,3193993284,3194811973,3196064412,319688731,319732319,3197468629,3197887975,3198273128,3203506472,320897310,3213247596,3214483467,3218980602,3220439072,3220443962,3220549428,3220631780,3221959801,3222739775,3223466730,3223544451,3223669094,3224948870,3224951437,3225513288,3226204903,3227336508,3227698758,3228099643,3228159758,3228176875,3228182137,3229605750,3229790431,3230615425,3231321252,3231773311,3232696392,3232931377,3233270437,3233403350,3235901762,3236277297,3236358454,3236975916,3236996959,3237028830,3237724296,3238063699,3238490989,3238496964,3238577323,3240300222,3240825806,3242021510,3242275410,3242794027,3243174642,3243581971,3243866046,3243933750,3245007782,3245657438,3245910828,3246526296,3247497793,3248389806,3248863370,3249401468,3249901747,3251175066,3251819408,3253676648,3253699273,325411278,3254115720,3254441754,3255452442,3255624343,3256709472,3256806422,3256870021,3258017005,3258488886,3258514818,3259253131,3259764108,3261180078,3261363678,3261939547,3264022435,3269278904,3269801436,3269962404,3270047244,3270120409,3270283560,3271003856,3271819807,3272417526,3272749176,3274791763,3275460842,3277610971,3278100224,3278366527,3278443435,3278745487,3278757122,3279194454,3279891590,3280607155,328069026,3280966723,3281115524,3281719518,3281882755,3282292190,3282493052,3282530065,3283128678,3284296645,328520426,3285772706,328606210,3286716654,3286764901,3287051060,3287573461,3288247482,3288735764,3288888972,3290426900,3291766974,3293079283,3294059906,3295576459,3297689940,3299440706,3299468378,3299689328,3300425845,3300533467,3301122377,3303062030,3303125906,3303163694,3303230952,3303742987,3304180152,330422123,3304429904,3304902732,3304968462,3307299373,3307873327,3308570153,3308859482,3308984256,3309258391,3311419754,3312329354,3314107411,3314169445,3317057221,331719389,3318053474,331980588,3320146548,3320974698,3321000372,3321090536,3321921170,332198096,3322610054,3323911494,3324395724,3324449185,332604305,3326494950,3326803638,3327224591,3327973580,3328197224,3335843720,3344400734,334702527,337050655,3381803713,3385280064,3387428060,338885806,3389125344,338963845,3390177735,3399889754,340017287,340105758,340276535,3405309739,341337747,341976790,3422231072,3424893374,3428446339,3428522113,343308979,343737925,3440320334,344072247,344586522,344783346,344799114,3448253832,3450635354,346069393,34613030,3464905573,3467363600,3468604218,3481339998,348228842,3483208525,3483848172,3486219014,3501482058,3504872414,3506427680,3515660842,351641012,351892213,3525468806,3530647874,3537847818,354340470,3544633513,354591974,3547196190,3549309913,355468384,3554694254,3557799734,3565722554,3572553979,357263379,3582082220,359093396,359354698,3594598632,3605982012,3618484394,3618885372,3626463372,362832358,3639517694,3643493474,3646950985,3648378318,365519932,3655836741,365849726,3660262040,3663528372,3665440160,3666321801,3668116093,3670365312,3670957224,3671979853,3672107053,3672130518,367806295,368782857,3703003519,370574103,370960434,371096273,371594737,3722068939,373842704,3739021398,3745717933,374948325,3756845653,3757435694,376089087,377179779,3772347924,3773329880,3776175193,3776288778,3776769019,3778070294,3779672292,378124670,378423277,3784247906,3788860212,379639825,3801563419,3805923912,3808844174,3812474953,3819672074,3820727234,382475899,3825853100,383183105,384246525,3845597593,385455574,385547772,385767908,3859863254,3862869132,386495215,3868255394,3869652133,3870160039,3870457534,3870657554,3872543233,3878661612,3880125978,3893874972,3902848753,390392791,390419756,390666789,390901443,3912559873,391299959,3914975065,3915711612,391722224,3925994713,3926933173,39273298,3943855092,3960072192,3964165874,3966332665,3968701459,396957034,3970303458,3971677633,397355109,3979810332,3987275899,3992653334,399347670,399561572,399702627,4001417772,4005302892,400689484,4011491774,4016168474,401709741,4024215559,4025120480,4025524754,4036045813,4036409598,4041155358,4041517754,4041838993,4042084034,404274172,4043920460,4044152412,404634544,4051986854,4055709134,4057486873,4064244673,4071054558,4075465164,408626587,4088216953,4091374932,4092808092,4093251612,409343539,409774384,4097787192,4098542060,4100176274,4102064414,4103254939,4104774253,4109300414,4112203284,411278105,4112950998,4113965714,4114398799,411448467,4114969518,4124563933,4125649940,4127722513,4131796034,413207566,413245549,4134498193,414378906,4147938493,414829234,414899672,415401725,4156245865,4163372652,4165511713,4173669194,4177540514,4184973614,4186016653,4192585512,4195711572,4201661953,4202217793,420361828,4207094592,420939257" ;

//"4216890193,421983113,4222710014,422400233,423416141,4234485434,423835144,4243695134,424805559,425001563,425417387,4257725604,4260911054,4262514559,426357160,4268681713,4269214406,4271863453,4272090314,4273524912,427422788,42861290,4296161534,4296216458,4298551093,4299942914,4299968652,4300517473,4300582514,4300771938,4300905074,4301540478,4301715913,4302300260,4302680727,4303190903,4304632659,4306059314,430766182,4314691054,431469160,4317604393,431783702,4318666341,4319311212,432109799,4321181475,432155218,432176704,4322196804,432626024,4327213274,432980093,4332612554,4333687220,4334339534,4344824652,4352207893,4356743179,4359761654,4361801431,4363579754,436427585,436488460,4368678192,437408822,4380135673,4380790932,4388079252,4388660474,4393324514,4396700353,439850719,4411246399,441599029,441733296,4418813124,4426368798,4430040980,4431998058,4444006638,4445687008,4449036012,445966278,446206679,4463992874,4475837053,4479130340,4479529333,4482205574,4490676494,449130488,450192376,4506831258,4513270693,4513319114,451909577,4521249562,452294305,452351043,4532521933,4535594244,453798298,4538395442,4551943812,4554046694,455618593,455656636,455767319,4557773472,4563078553,4565278993,4565420112,4573270879,457330904,4573353979,4575636194,457679713,4576811294,4583165353,458327172,4585081398,4586083609,458898549,4591752756,4593152540,4593876805,4594276394,4595544925,4596162079,4601878884,4608032474,4608577213,4612809332,4614595574,461697013,4629364754,4629486974,4631281201,4634387592,4635720120,4640414475,4641471978,4642730779,4643001757,464418322,4650399373,4650450380,465242446,465411829,4654189940,4654410602,4655837240,4659958752,466064216,4661089898,4661176087,4661714060,4663481533,4664748979,4666584860,4669693633,4670600455,4672192628,4673280014,4673896544,4675722391,4676229607,4676335891,4676631985,4677093320,4677244705,4677536893,4678685382,4679294840,467972366,4680160333,4680885858,4682879863,468396289,4691027814,469276232,4694427486,4697081916,4697784727,4700237396,4702848133,4706472554,4707314024,4708410024,4710762126,4711056282,471108327,4711528014,4711936104,471214786,4714007774,4714019834,4714543718,4717695901,4718440218,4719004465,4719037933,4719443917,4719900990,4721386255,4724658194,4726275372,4727000618,4729377836,4731783745,4731931164,4733113104,4734013999,4734216517,4735972417,4737435253,4737473413,4738158025,4738276490,473861684,4739466056,4740502272,4741190953,4742547194,4742882124,4743355932,474400936,4746236240,4748845459,4750472653,4752405985,4752704976,4753357937,4758323408,4764358220,476437475,4764992618,4765827373,476807144,4768573692,4768965847,4773502418,4773792614,4774799474,477508843,4777226804,4782332365,4787486124,4788970273,4789185618,4795699334,47978329,4798258758,4798854257,4800495920,4801574342,4802480522,4803884551,4805100944,4805779255,4806036973,4806676459,4808174102,4808967045,4811144472,481165753,4813779284,4815739559,481710488,4817335632,4818475922,4823991321,4830054326,4831295688,4833124075,4833347197,4833453260,4833670519,4833803955,4834611680,4835420514,4835592858,4835787222,483653218,4838528179,483919986,4840335134,4840885423,4841211674,4844803160,4845471200,4845477978,4847471834,4848051613,4848631565,4848683899,4848714471,4849092520,4849678346,4851570729,4852366429,4853211895,4853255732,4853443597,4855954152,4856111661,4857573799,4859620056,4859878192,4862576990,4865429618,4872392605,487258313,4873367838,4874518166,4878343936,4879733177,4880078830,4880654435,4881513585,4881826943,4882296454,4882693478,4883854692,4887163831,4888345035,4888352858,4888685619,4888973021,4889212473,4889285339,48913837,4891815918,4892658794,4892753785,4893145034,4893559920,4893895939,4895111245,4898218220,4899939078,4903519853,4903578859,4903760839,4905696690,4907036436,4908879012,4911687200,491359713,4918959774,4919166744,492093087,49241517,49247264,4926180421,4926365095,493419476,494987824,495674459,497573084,498512283,498592764,499733970,499766535,499828277,503948700,504352595,505847684,506057650,509033485,510361337,512740852,513293612,513906542,517208498,517671508,517742026,520393346,520654714,522153245,523534461,528522333,529174502,529874058,532003908,532521853,533774959,534326099,535374315,53629055,538022530,538303281,538664236,541353376,541823175,54229625,543429521,543574540,544168347,546111668,549071527,549840445,551601323,555011355,555651344,560244173,561254750,562633272,562800882,563029933,564338116,564455395,564569513,564932345,565293322,565468481,566815904,56690190,56923384,569277206,573616146,573629562,575304620,578706818,579698375,580468780,581731614,584852552,584897809,585102441,585241339,585583594,585584882,585745452,587238716,587910774,590813667,592792598,596550735,599283189,602961030,606259885,608295710,609476672,615064977,615074304,620084555,624343345,627301228,62784113,627956300,631275007,632051760,633702675,635484875,635882171,636280117,67184670,696705984476155904,697378094496161792,697806914281811968,697814574355976192,700403418603491328,700485315773857792,700671205,700675724315795456,700697118411915269,700815845660844032,701005999264501760,701061005569163265,701109258285244416,701133365890551808,701474585300996096,701735313446600704,702098434229055488,702287193583190016,702348213416644608,702704871112208384,702811727650385921,702837865210712066,702843335447224321,703093692807000066,703142862318272512,703317025,703545262552150016,703590966809088000,703595145984233476,703625583129862144,703627865368047616,703628354923032576,703916081379823617,703959229032345600,703966155497566208,704293663304712194,704318019602743296,704363984720306176,704391899990208512,704423822733119488,704573559251693568,704576498,704590427106578432,704645417275764737,704649776738926592,704675014524600321,704706287733383168,704763387259957248,704894442113736704,704904135628431365,704916713440223233,704936332951474179,704974295454261248,705008524451926016,705101885372370944,705304189405175808,705396147817304064,705700557554487296,705779865849450496,705818392964395008,705843934447034368,705917199244873728,706121872950231041,706151861041037317,706284177432322048,706301270718414848,706372293719490560,706563373832368128,706685235564453888,706693491020005376,707651453645500416,707675334091485184,707792095377891328,707839309114544128,708122263267057665,708251237825687552,708271021158105088,708281470993838080,708306312942067712,708478436101136385,708489288,708539345221734400,708567587387367424,708587098081615872,708651545613570048,708856455273689088,708980574271082496,709197538746703872,709216478898204672,709285008473591808,709393560429154306,709405535498424320,709543702075559936,709589752144465920,709692897734500352,709703908550049793,709719037429698560,709744377346699268,709924248878362624,710022352294125568,710102562943344641,710109724939661312,710148699259731968,710284924218056704,710424978202632192,710458163489673216,710504574566543360,710505081829875713,710512256,710931963843112961,711039015621779456,711133585214812161,711151800800272385,711179215052230656,711205392970227713,711226301122633729,711238638495903744,711360231033311232,711417388353257472,711422362822938625,711485704446939136,711515879746351104,711574166785265664,711738419290857472,711744362254700544,712090396310933504,712145307149012993,712242460890521600,712293232659398657,712643415561805825,713184209880240128,713207257509462020,713325756240101376,713333749501394944,713358774719750144,713541102318460928,713701726977523712,713761143672573952,713791638330429440,714105488200208384,714129918666215424,714349470645784576,714434542006710274,714452072930762753,714672788120985602,714684493450321924,714701947887026177,714768761778270209,714780246067707904,714788852737511424,714825433812848640,714840437085745152,715039353068716032,715119219143147520,715164673360809984,715176723772350464,715181541970681857,715183660924674048,715196240120520704,715197401682739200,715253821132267520,715397312982294529,715418413,715450844439715840,715455095068954624,715550884923445248,715751518268432389,715770280677875712,715787631720796160,715789971605561344,715828871661232128,715867198418358272,716016315660537856,716054798701883394,716082497260359680,716089040378814464,716250739538927617,716283008773324801,716457780580716544,71659113,716609596022874113,716648090661355521,716649067804098560,716686507323428865,716759488707989504,716792269106323458,716798966357069824,716814662621265920,716961276396593153,716969882349228032,716989214588416000,717000747624177664,717057934463610880,717168094192410624,717262001362239488,717308824344862720,717352885005131776,717366584763764736,717368458481049600,717371906551185408,717393102567186433,717432280394768384,717510082859143168,717544202687516673,717547279960281088,717569969001615360,717578309886828544,717650495695822848,717718526996254721,717732762199785472,717882788528001024,717945694112210944,717965017040048128,718004979038990336,718014894268747776,718095896618016769,718183643395457024,718227350559830016,718354428449931264,718384639350542336,718401416310743041,718517803934810112,718534901293711360,718585296011407361,718597567269842944,718676374571995136,718784205656698880,718790216375373824,718838194632921088,718887436823040000,718933765867704320,718969287524765696,719057691239325696,719061995362721792,719196150528548864,719198739886252033,719208828055621632,719238497391869952,719249416264265728,719477573676208128,719500684295417856,719505042642903040,719519800490262529,719554207238344705,719566166839025664,719818040158715905,719852188370104320,719861360989970432,719864033176891392,719876233266335744,719899035633590273,719926551266000896,719965662601289728,720026096855564291,720061610371338241,720065614799220736,720114416218411008,720128942015934464,720139951933956096,720212671123972096,720243290017103872,720250572280991745,720267900884418561,720268524308922369,720692526798151680,720789315182198784,720799849285689348,720820672750981120,720831995496894464,720834216737398784,720836383707795456,721253190008582144,721276983389237248,721500680049938433,721532478310100993,721579321194717192,721582065683079169,721653003443286016,721680616018673664,721709413019443200,721723273361293313,721801282676101120,721815471377350656,721850157067685888,721955531783417857,722016828659081216,722074571784867841,722099085130338304,722159075903975424,722215694310309888,722239547497537536,722470119494983680,722507094671273984,722647916712697856,722661409990057984,722689102466916352,723179540986486784,723297871227850752,723303699305504769,723343486938812416,723403041781649408,723482583263145985,723566968746303488,723568287179632641,723734080328593409,723791301712351233,723799278,723818902875082752,723832968553193472,723848952194330624,723892651108397056,723913565787164672,724100544764112896,724112946142408704,724141828040175616,724214148842688521,724261851056369665,724317836114464770,724343098164137984,724382107544350721,724835928498409472,724898473405997056,724956708246839296,724976478815813632,725008910147440640,725337869506605057,725397232422281217,725670571283877890,725718595242618881,725988158064578560,725996889804398592,726019849177063424,726200824506916864,726314869,726549597821227008,726638521264443392,726699279092305920,726734525196193792,726758000736669700,726761408487018500,726768482017136640,726772069610852352,726796808412758016,726837776029614081,726947623530176512,726985036965122048,727035851968942080,727066063427371008,727069847541059584,727090066162487296,727181749751410688,727335669895409669,727380614647824384,727438077350703105,727498542491652097,727507031490367488,727535525192568832,727535792487190528,727632310154076160,727701739701293057,727736456140165120,727865150997303296,727900164480884737,728098715374788608,728223706955194368,728631685634363393,728779332886220801,728788179126358016,728984451334561794,729029176150269952,729136909952294912,729154460908294148,729222579987177472,729230001569062912,729274847386324992,729307685837905921,729325793134813184,729611681630801920,729902655707865089,730240735463641089,730300974804271104,730355680851304449,730402774282702850,730485947746291713,730697285928026112,730889378931728384,730996557793787905,731057197883367424,731162439765483520,731236999194017792,731267971625050112,731518205265481728,731519330861490176,731570886378053632,731661075045879809,731697370308562944,731717883630260224,731724991973052416,731763019869380609,731823993632624640,731845198460817408,731868615696220160,731958075062521856,732174341610201089,732178648833261568,732208452370489344,732225263522570241,732308530909208576,732535766698446848,732552191295164417,732621755643203584,732819066692509696,732888126847229953,733112584249839617,733330550920908800,733336865428791296,733679835801870336,734026559930007553,734031084795498496,734034069118275588,734052666666422274,734444407118651392,734674867371446276,734737001732177920,734737121622122501,735051537051832321,735076517126905856,735143318300950528,735145370678755328,735347531450834944,735402776595828737,735578864,735660427254714368,735716501257232388,735890540122669056,736025143760166914,736055992568270849,736154563086974976,736186235593490432,736205891293216768,736327022050304001,736384488809193473,736434466118197248,736460635358171136,736594998737522688,736604427658792960,736613723356332034,736646988016418816,736700707777089536,736780349372432385,736886695681875968,736916043755454464,737110023017365504,737166165202505729,737198292002471937,737257274582827008,737343310444953601,737423946232926209,737483799252979712,737823521162723328,737832263035932672,737902885309145088,738033576957095936,738329773496139777,738349757798617088,738365284453490688,738555626205241344,738603655830462466,738633340903776256,738684880800731137,738777588106039296,739000364913938432,739057617163554816,739064318990254081,739127565424562176,739168521356120064,739257735116525568,739274055996432385,739318916330049538,739349471155212288,739464340428853253,739652588174348296,739771893482323968,739792783968325632,739827826577137665,739986812454608897,740461851494993920,740470895815200768,740521806906298368,740576126209134592,740594583176761344,740601573445771265,740602621816233984,740726184179163136,740822967039430656,740861496712790019,74123239,741253851559297024,741275068706086912,741605923513204737,741830824513785857,741845589323710465,741873636915568640,741889391639953408,741979566374158336,742016654175916033,742249430342983680,742346085952196608,742498017408737280,742785018561331202,743025188007116801,743210592,743408099495600129,743441389849976832,743456911966646272,743776229774360576,743783702283460608,743785405963657217,743787349104943104,743842659874201602,743844079159566336,744021087130951684,744062463906316288,744156436704309249,744178195683913732,744347509946867713,744563647628738561,744674512164163585,744794249623805952,744822622085480448,744827815149744129,744890852795809792,745119312441020418,745194970953318400,745488834507333639,745780607259545600,745899565509902336,746140940725714944,746194951885586434,746339833740562432,746343159047720960,746346131571957760,746361815597088768,746479054648291329,746498877423915008,746522344181497856,746561298578563072,746570065898672128,746573692868530176,746670103589097472,746724571563208705,746857097732591616,746871626881339392,746883733840551936,746889905855311873,746894610325086209,746899748943077376,746953219700490240,746956284256083968,747029879468658689,747061068304814080,747078602110296069,747094635235811328,747097004094808065,747175688612913152,747239744606601217,747269332946690048,747431171731009536,747476239,747488267830845440,747530449774206976,747656049017110528,747752112323321856,747877981301837824,747881151646208000,747943211625132033,747947350690168834,748052265727045632,748144474350460928,748156976689909760,748183978104872962,748209566341443588,748307944958136320,748355547116670976,748436375926509568,748543514036707328,748685460717727746,748800136214491136,748945838269800448,749096435660886016,749172510411722752,749224358820753409,749238441682931714,749430264007237632,749436030416064512,749695742457942016,749824210256539648,749842352559132672,750294499876679680,750336135302295552,750612183516532737,750784622305222656,750844876049117184,751089055748751360,751210873818001409,751542456097705984,751548418279874560,751615353436844034,751629106790342657,751693496835186689,751745639537487872,751753466062577665,751767255730364416,751955516,752021117393526784,752370262847262720,752494205335777281,752508797747286016,752536738585653248,752566682267242498,752658542394347522,752749802,752874206,752933433496567808,753028143229788161,753082900552253441,753154085587521537,753421158062579712,753530779410366464,753735633319919616,753773987423932416,754146625421844480,754152871294140416,754309565978595329,754320269179625472,754422164388851713,754446627054628865,754535285333962752,754541410146131968,754661593095352320,754697809316634625,754701030701445120,754871963886104576,754906159341899776,755204765743652864,755369284818259970,755417731369881600,755437141581193216,755573413117173760,755691545760714753,755990515850412032,756012817971425280,756029716201558017,756040974267068416,756072930996580352,756079174264066049,756084525705289730,756085219677970432,756129847085142016,756136001232220160,756152426852327425,756157770781470720,756166538055421952,756171395571212290,756231173886533634,756259647472803840,756351595386802182,756409365670703104,756511333294669825,756523993079943169,756527925554479104,756544054041587712,756674204444090368,756843906843615232,756854893512564736,757020870,757078479577882624,757087677086785536,757254656661655552,757276379700350976,757315289184743424,757488871944835072,757517320797376512,757609356586160128,757617759719088128,757653769836388352,757803707035553792,757880132,758012164263124992,758045697555828736,758205076150243328,758655835157463040,758687675939328001,758858924619509760,758881362967302144,759044130953498625,759061396285906950,759103098933563392,759157953735696384,759166870729568256,759172271055310848,759177034178277378,759262782416183297,759403158074372096,759426506556706816,759549033232818176,759730248166445056,759946972748840960,759954375284449282,760055442584182784,760088676273487872,760390972190527490,760446373271449601,760562423149502468,760587335092146176,760662326856908801,760666989027135488,760778123432501248,760789919681748993,760839262472286208,760895429114408960,761060057878364160,761094030151127042,761425455962402816,761433369389375488,761496709,761500526475227137,761506838919585793,761906303488757761,761943239830097920,762024625534406657,762188143328047104,762241061490089984,762287042055184384,762635969879085056,762687216095113217,762697420480274432,762881356468662273,762942008193196033,763051160500473856,763226248608833536,763363343427969024,763387403872501760,763402693440184320,763406686648348672,763549907613462528,763616274685562880,763660508792623108,763771201407754240,763816626504413185,763933362394320900,763983736429871104,764047224405798912,764258663267651584,764285539545743361,764370461274677248,764481741297856512,764502339793199104,764505891098005506,764896947652014080,764997913319616512,765037527308771328,765075248492314624,765170174483759108,766056694791168000,766216819615072261,766264261970649088,766270974014722048,766305588263485440,766330689289592832,766331015866490880,766343348084994048,766565768280412161,766617804309094401,766627976091803648,766646102758002690,766653515900989440,766673836238475264,766843789776347136,766847847626977280,766918538313420800,766928505674141696,766945757685362688,766979612341440512,766979940294144000,767015930899542016,767129753065181184,767269781858684928,767282315877765120,767286196422619136,767395724942114816,767585600182456321,767622255144636416,767739822542688257,767834460553252864,768036226586726400,768251509700124672,768253880295563265,768291886758895616,768427146712801280,768501067369721856,768725195276169216,768781550896885761,768820889508978688,768825859767533568,768838302866690048,768853829878095872,769005526457782276,769028970033647616,769057321121091586,769168008015073280,769281633094541312,769301100444786688,769337439139749888,769501486896164864,769560592172453888,769561213856456705,769575672565989376,769605056144379904,769616125994741760,769712297761660931,769753273028923392,769835712803844096,769905498338369537,769935270275747840,770135648653209602,770167350893031425,770206433472229380,770567496348766208,770688012803977216,770710022753964033,770723268496023553,770819136905629696,770863140103790592,770897413078777856,770907422873399296,770910937435951104,770957094304395265,770964295907631105,770966205762973702,770986059698024448,771154768311877632,771174091675926528,771176117524770819,771216518663196673,771264364322000897,771293601418530819,771296120576237570,771329363547529217,771388971905523712,771447719537684480,771561797199343617,771610283362050048,771619026522910720,771642783455023104,771658029783658496,771667269952741376,771668386635886593,771678179907948544,771693794211139585,771693984179687425,771710010397110274,771725415912185857,772068783309541376,772081660980436992,772140582571347968,772224516046983168,772339087181160449,772353115995594752,772364932557905921,772372105463631872,772399648812126209,772416999515234304,772560600358539264,777398407,778555950,785914213,787366208,792010933,793095258,79383736,795652375,79706170,797860776,799541635,800682349,809964872,81048096,81378462,816938718,817103888,81886921,820788486,82140728,824113076,82569614,827022206,82862540,82864602,82932685,831297361,83521304,836635214,83809152,839369413,847032499,847674096,85019457,852861276,85512028,855605959,858991784,860474964,864288811,86649618,870906134,871798572,87181342,873432434,873727566,873886423,874975364,875326712,87888889,88613888,88848442,892626602,894052381,89452542,89951980,89962065,903619416,903859626,905536562,905847949,906498992,90661747,908083602,91330279,914578344,915199189,91527291,916055208,917794946,918977034,921933512,923103030,928760443,928919246,931348902,93184944,937333819,93803940,93912750,93921349,939232339,939878912,941002975,941488790,94215348,94495037,94539288,952236164,958772389,960522853,961711938,968236969,969812473,971312276,978603128,98236233,988630772,989284393,995131410,999013164,99917014" ;


console.log("userids.len=" + userids.split(",").length) ;

var stream1 = client.stream('statuses/filter', {follow: userids});

stream1.on('data', function(event) {

    if( event                        != null && 
        event.text                   != null && 
        event.text                   != ""   && 
        event.text.length             > 0    && 
        event.text.indexOf("参戦ID") != -1 ) {
        wsServer.doParseTweet(event , "streaming") ;
    }
}) ;
